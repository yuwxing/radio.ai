<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio.AI - æ²»æ„ˆç³»AIè¯­éŸ³ç”µå°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap');

        :root {
            --soft-blue: #a7c5eb;
            --soft-purple: #c9a7eb;
            --soft-pink: #f3c1e1;
            --soft-green: #b8eacb;
            --soft-yellow: #f0e68c;
            --light-beige: #f9f5eb;
            --warm-white: #fffdf8;
            --soft-gray: #e0d8d0;
            --muted-teal: #a3c4bc;
            --healing-shadow: 0 4px 20px rgba(167, 197, 235, 0.3);
            --healing-shadow-alt: 0 4px 15px rgba(201, 167, 235, 0.2);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, var(--light-beige) 0%, var(--warm-white) 100%);
            min-height: 100vh;
            color: #5a5a5a;
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(167, 197, 235, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(201, 167, 235, 0.1) 0%, transparent 20%);
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 253, 248, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 25px;
            padding: 35px;
            box-shadow: var(--healing-shadow), 0 8px 32px rgba(167, 197, 235, 0.2);
            border: 1px solid var(--soft-blue);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, var(--soft-blue), var(--soft-purple), var(--soft-pink), var(--soft-green));
            z-index: -1;
            border-radius: 27px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
        }

        @keyframes gradientPulse {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        header {
            text-align: center;
            margin-bottom: 35px;
            position: relative;
            padding-bottom: 25px;
        }

        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            right: 25%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--soft-blue), transparent);
        }

        h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            background: linear-gradient(45deg, var(--soft-blue), var(--soft-purple), var(--soft-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 500;
            letter-spacing: 1px;
        }

        .user-info {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(201, 167, 235, 0.15);
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 0.95em;
            border: 1px solid var(--soft-purple);
        }

        .logout-btn {
            background: rgba(201, 167, 235, 0.25);
            border: 1px solid var(--soft-purple);
            color: #5a5a5a;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            margin-left: 12px;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: rgba(201, 167, 235, 0.4);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.8;
            margin-bottom: 20px;
            color: var(--soft-purple);
        }

        .app-description {
            text-align: center;
            margin-bottom: 35px;
            font-size: 1.1em;
            opacity: 0.85;
            color: var(--soft-blue);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-bottom: 35px;
            flex-wrap: wrap;
            position: relative;
        }

        .controls::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--soft-pink), transparent);
        }

        .btn {
            padding: 16px 35px;
            font-size: 1.1em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 253, 248, 0.8);
            color: var(--soft-blue);
            backdrop-filter: blur(5px);
            min-width: 160px;
            font-family: 'Noto Sans SC', sans-serif;
            font-weight: 500;
            border: 1px solid var(--soft-blue);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(167, 197, 235, 0.2), transparent);
            transition: 0.5s;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: var(--healing-shadow), 0 6px 20px rgba(167, 197, 235, 0.4);
            background: rgba(255, 253, 248, 1);
        }

        .btn:hover:not(:disabled)::before {
            left: 100%;
        }

        .btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-listen {
            background: rgba(167, 197, 235, 0.2);
            border: 1px solid var(--soft-blue);
            color: #4a6fa6;
        }

        .btn-listen:hover:not(:disabled) {
            background: rgba(167, 197, 235, 0.3);
        }

        .btn-stop {
            background: rgba(243, 193, 225, 0.2);
            border: 1px solid var(--soft-pink);
            color: #c17aa6;
        }

        .btn-stop:hover:not(:disabled) {
            background: rgba(243, 193, 225, 0.3);
        }

        .status-section {
            background: rgba(255, 253, 248, 0.7);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--soft-blue);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .status-section::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--soft-blue), var(--soft-purple), var(--soft-pink), var(--soft-green));
            z-index: -1;
            border-radius: 21px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
            opacity: 0.2;
        }

        .section-title {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.2em;
            color: var(--soft-purple);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .clear-history {
            background: rgba(243, 193, 225, 0.25);
            border: 1px solid var(--soft-pink);
            color: #c17aa6;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .clear-history:hover {
            background: rgba(243, 193, 225, 0.4);
        }

        .status-content {
            line-height: 1.7;
            min-height: 70px;
            background: rgba(255, 255, 255, 0.6);
            padding: 15px;
            border-radius: 12px;
            word-wrap: break-word;
            border: 1px solid var(--soft-gray);
            box-shadow: inset 0 0 10px rgba(167, 197, 235, 0.2);
        }

        .current-track {
            background: rgba(255, 253, 248, 0.7);
            padding: 25px;
            border-radius: 20px;
            margin-top: 25px;
            text-align: center;
            display: none;
            border: 1px solid var(--soft-green);
            box-shadow: var(--healing-shadow-alt);
            position: relative;
            overflow: hidden;
        }

        .current-track::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--soft-green), var(--soft-blue), var(--soft-purple), var(--soft-green));
            z-index: -1;
            border-radius: 21px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
            opacity: 0.2;
        }

        .track-info {
            margin-bottom: 18px;
            font-size: 1.3em;
            color: var(--soft-green);
        }

        .audio-player {
            width: 100%;
            margin-top: 18px;
            border-radius: 12px;
            box-shadow: var(--healing-shadow-alt);
        }

        .visualizer {
            height: 65px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            margin: 18px 0;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--soft-gray);
            box-shadow: inset 0 0 10px rgba(184, 234, 203, 0.3);
        }

        .visualizer-bar {
            position: absolute;
            bottom: 0;
            width: 5px;
            background: var(--soft-green);
            border-radius: 3px 3px 0 0;
            animation: visualizerWave 2s infinite ease-in-out;
            box-shadow: 0 0 8px var(--soft-green);
        }

        @keyframes visualizerWave {
            0%, 100% { height: 15%; }
            50% { height: 85%; }
        }

        .instructions {
            background: rgba(255, 253, 248, 0.7);
            padding: 25px;
            border-radius: 20px;
            margin-top: 25px;
            border: 1px solid var(--soft-yellow);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .instructions::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--soft-yellow), var(--soft-green), var(--soft-blue), var(--soft-yellow));
            z-index: -1;
            border-radius: 21px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
            opacity: 0.2;
        }

        .instructions h3 {
            margin-top: 0;
            color: var(--soft-yellow);
            font-weight: 600;
        }

        .instructions ul {
            padding-left: 25px;
        }

        .instructions li {
            margin-bottom: 12px;
            line-height: 1.7;
            color: #6a6a6a;
        }

        .highlight {
            background: rgba(167, 197, 235, 0.2);
            padding: 3px 8px;
            border-radius: 6px;
            font-weight: 500;
            border: 1px solid var(--soft-blue);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin: 25px 0;
        }

        .quick-btn {
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: rgba(167, 197, 235, 0.15);
            color: #4a6fa6;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans SC', sans-serif;
            font-weight: 500;
            border: 1px solid var(--soft-blue);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .quick-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(167, 197, 235, 0.2), transparent);
            transition: 0.5s;
        }

        .quick-btn:hover {
            background: rgba(167, 197, 235, 0.25);
            transform: translateY(-2px);
            box-shadow: var(--healing-shadow), 0 5px 15px rgba(167, 197, 235, 0.3);
        }

        .quick-btn:hover::before {
            left: 100%;
        }

        .volume-control {
            margin: 20px 0;
            text-align: center;
        }

        .volume-slider {
            width: 100%;
            margin: 12px 0;
            -webkit-appearance: none;
            height: 12px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.6);
            outline: none;
            border: 1px solid var(--soft-gray);
            box-shadow: inset 0 0 8px rgba(167, 197, 235, 0.2);
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--soft-blue);
            cursor: pointer;
            box-shadow: var(--healing-shadow);
        }

        .text-input-area {
            background: rgba(255, 253, 248, 0.7);
            padding: 20px;
            border-radius: 20px;
            margin: 25px 0;
            border: 1px solid var(--soft-green);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .text-input-area::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--soft-green), var(--soft-blue), var(--soft-purple), var(--soft-green));
            z-index: -1;
            border-radius: 21px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
            opacity: 0.2;
        }

        .text-input-area textarea {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--soft-green);
            background: rgba(255, 255, 255, 0.7);
            color: #5a5a5a;
            resize: vertical;
            min-height: 70px;
            font-family: 'Noto Sans SC', sans-serif;
            font-size: 1em;
            box-shadow: inset 0 0 10px rgba(184, 234, 203, 0.3);
        }

        .text-input-controls {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }

        .text-input-btn {
            flex: 1;
        }

        .loading {
            display: inline-block;
            width: 22px;
            height: 22px;
            border: 3px solid rgba(167, 197, 235, 0.3);
            border-radius: 50%;
            border-top-color: var(--soft-blue);
            animation: spinHeal 1s ease-in-out infinite;
            box-shadow: var(--healing-shadow);
        }

        .voice-selector {
            background: rgba(255, 253, 248, 0.7);
            padding: 20px;
            border-radius: 20px;
            margin: 25px 0;
            border: 1px solid var(--soft-purple);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .voice-selector::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--soft-purple), var(--soft-pink), var(--soft-blue), var(--soft-purple));
            z-index: -1;
            border-radius: 21px;
            background-size: 400% 400%;
            animation: gradientPulse 8s ease infinite;
            opacity: 0.2;
        }
        
        .voice-options {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .voice-option {
            flex: 1;
            min-width: 130px;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: rgba(201, 167, 235, 0.15);
            color: #6a5a7a;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans SC', sans-serif;
            font-weight: 500;
            border: 1px solid var(--soft-purple);
            box-shadow: var(--healing-shadow);
            position: relative;
            overflow: hidden;
        }

        .voice-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(201, 167, 235, 0.2), transparent);
            transition: 0.5s;
        }

        .voice-option:hover {
            background: rgba(201, 167, 235, 0.25);
            transform: translateY(-2px);
            box-shadow: var(--healing-shadow), 0 5px 15px rgba(201, 167, 235, 0.3);
        }

        .voice-option:hover::before {
            left: 100%;
        }

        .voice-option.selected {
            background: rgba(167, 197, 235, 0.3);
            border: 1px solid var(--soft-blue);
            color: #4a6fa6;
        }

        @keyframes spinHeal {
            to { transform: rotate(360deg); }
        }

        .search-results {
            background: rgba(255, 255, 255, 0.6);
            padding: 18px;
            border-radius: 12px;
            margin-top: 18px;
            max-height: 220px;
            overflow-y: auto;
            border: 1px solid var(--soft-gray);
            box-shadow: inset 0 0 10px rgba(167, 197, 235, 0.2);
        }

        .result-item {
            padding: 12px;
            margin: 6px 0;
            background: rgba(167, 197, 235, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--soft-blue);
        }

        .result-item:hover {
            background: rgba(167, 197, 235, 0.2);
            transform: translateX(6px);
            box-shadow: var(--healing-shadow);
        }

        .result-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--soft-blue);
        }

        .result-desc {
            font-size: 0.95em;
            opacity: 0.8;
            color: #6a6a6a;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 15px;
            }
            
            h1 {
                font-size: 2.2em;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 320px;
            }
            
            .user-info {
                position: static;
                display: block;
                margin-top: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸŒ¸ Radio.AI</h1>
            <div class="user-info" id="userInfo">
                ç”¨æˆ·: <span id="usernameDisplay">è®¿å®¢</span>
                <button class="logout-btn" id="logoutBtn" title="é€€å‡ºç™»å½•">ç™»å‡º</button>
            </div>
            <div class="subtitle">æ²»æ„ˆç³»AIè¯­éŸ³ç”µå°</div>
            <div class="app-description">æ¸©æš–çš„å£°éŸ³é™ªä¼´ï¼Œè®©å¿ƒçµå¾—åˆ°æ…°è—‰ä¸æ”¾æ¾</div>
        </header>
        
        <div class="controls">
            <button id="listenBtn" class="btn btn-listen">ğŸ¤ å¼€å§‹è†å¬</button>
            <button id="stopBtn" class="btn btn-stop">â¹ï¸ åœæ­¢</button>
        </div>
        
        <div class="text-input-area">
            <textarea id="textInput" placeholder="åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„éœ€æ±‚ï¼Œä¾‹å¦‚ï¼šæƒ³å¬è‹±æ–‡ç‰ˆçš„ã€Šé£˜ã€‹ã€ç»™æˆ‘æ¥ä¸€æ®µæ–°é—»è§£è¯´ã€è®²ä¸ªæ¸©é¦¨çš„æ•…äº‹ç­‰"></textarea>
            <div class="text-input-controls">
                <button id="textSubmitBtn" class="btn text-input-btn">ğŸ’¬ å‘é€æ–‡å­—æŒ‡ä»¤</button>
                <button id="textClearBtn" class="btn" style="background: rgba(243,193,225,0.2); border: 1px solid var(--soft-pink);">ğŸ—‘ï¸ æ¸…ç©º</button>
            </div>
        </div>
        
        <div class="voice-selector">
            <div class="section-title">
                è¯­éŸ³é€‰æ‹©ï¼š
            </div>
            <div class="voice-options">
                <button class="voice-option selected" data-voice="female1">æ¸©æŸ”å¥³å£°</button>
                <button class="voice-option" data-voice="male1">æ¸©æš–ç”·å£°</button>
                <button class="voice-option" data-voice="female2">æ¸…æ–°å¥³å£°</button>
                <button class="voice-option" data-voice="male2">èˆ’ç¼“ç”·å£°</button>
            </div>
        </div>
        
        <div class="quick-actions">
            <button class="quick-btn" onclick="quickCommand('æƒ³å¬è‹±æ–‡ç‰ˆçš„ã€Šé£˜ã€‹')">é£˜(è‹±æ–‡)</button>
            <button class="quick-btn" onclick="quickCommand('ç»™æˆ‘è®²ä¸ªæ¸©é¦¨çš„æ•…äº‹')">æ¸©é¦¨æ•…äº‹</button>
            <button class="quick-btn" onclick="quickCommand('æ’­æ”¾æœ€æ–°ç§‘æŠ€æ–°é—»')">ç§‘æŠ€æ–°é—»</button>
            <button class="quick-btn" onclick="quickCommand('è§£é‡Šä¸€ä¸‹é‡å­è®¡ç®—')">é‡å­è®¡ç®—</button>
        </div>
        
        <div class="status-section">
            <div class="section-title">
                ç³»ç»ŸçŠ¶æ€ï¼š
            </div>
            <div id="statusContent" class="status-content">æ¬¢è¿æ¥åˆ°æ²»æ„ˆç³»AIè¯­éŸ³ç”µå°ï¼è®©æ¸©æš–çš„å£°éŸ³é™ªä¼´æ‚¨</div>
        </div>
        
        <div class="status-section">
            <div class="section-title">
                æœ€è¿‘æŒ‡ä»¤ï¼š
                <button class="clear-history" id="clearHistoryBtn">æ¸…ç©º</button>
            </div>
            <div id="historyContent" class="status-content">æš‚æ— å†å²è®°å½•</div>
        </div>
        
        <div id="currentTrack" class="current-track">
            <div class="track-info">ğŸµ æ­£åœ¨æ’­æ”¾: <span id="trackTitle">AIç”Ÿæˆå†…å®¹</span></div>
            <div class="visualizer" id="visualizer">
                <!-- éŸ³é¢‘å¯è§†åŒ–æ•ˆæœ -->
            </div>
            <audio id="audioPlayer" class="audio-player" controls>
                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾ã€‚
            </audio>
            
            <div class="volume-control">
                <label for="volumeSlider">éŸ³é‡æ§åˆ¶:</label>
                <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.1" value="0.7">
            </div>
        </div>
        
        <div class="instructions">
            <h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
            <ul>
                <li><strong>è¯­éŸ³æ§åˆ¶:</strong> ç‚¹å‡» <span class="highlight">ğŸ¤ å¼€å§‹è†å¬</span> æŒ‰é’®ï¼Œè¯´å‡ºæ‚¨çš„éœ€æ±‚</li>
                <li><strong>æ–‡å­—è¾“å…¥:</strong> åœ¨æ–‡æœ¬æ¡†ä¸­è¾“å…¥æ‚¨çš„éœ€æ±‚ï¼Œç„¶åç‚¹å‡» <span class="highlight">ğŸ’¬ å‘é€æ–‡å­—æŒ‡ä»¤</span></li>
                <li><strong>æ”¯æŒçš„è¯·æ±‚æ ¼å¼:</strong> 
                    <ul>
                        <li>å†…å®¹ç±»å‹: <span class="highlight">"æƒ³å¬è‹±æ–‡ç‰ˆçš„ã€Šé£˜ã€‹"</span>, <span class="highlight">"ç»™æˆ‘è®²ä¸ªæ¸©é¦¨çš„æ•…äº‹"</span></li>
                        <li>è¯­è¨€æŒ‡å®š: <span class="highlight">"ç”¨è‹±æ–‡ä»‹ç»äººå·¥æ™ºèƒ½"</span>, <span class="highlight">"ä¸­æ–‡è§£è¯´é‡å­ç‰©ç†"</span></li>
                        <li>ä¸»é¢˜è¯·æ±‚: <span class="highlight">"è§£é‡Šä¸€ä¸‹åŒºå—é“¾"</span>, <span class="highlight">"æ’­æ”¾æœ€æ–°æ–°é—»"</span></li>
                    </ul>
                </li>
                <li><strong>è¯­éŸ³é€‰æ‹©:</strong> åœ¨è¯­éŸ³é€‰æ‹©åŒºåŸŸé€‰æ‹©æ‚¨å–œæ¬¢çš„å£°éŸ³é£æ ¼</li>
                <li><strong>æµè§ˆå™¨æ”¯æŒ:</strong> æ¨èä½¿ç”¨ç°ä»£æµè§ˆå™¨è·å¾—æœ€ä½³ä½“éªŒ</li>
            </ul>
        </div>
    </div>

    <script src="ai-voice-generator.js"></script>
    <script>
        // åº”ç”¨ç¨‹åºä¸»è¦é€»è¾‘
        document.addEventListener('DOMContentLoaded', function() {
            // åˆ›å»ºAIè¯­éŸ³ç”Ÿæˆå™¨å®ä¾‹
            const aiVoiceGen = new AIVoiceGenerator();
            
            // DOMå…ƒç´ å¼•ç”¨
            const listenBtn = document.getElementById('listenBtn');
            const stopBtn = document.getElementById('stopBtn');
            const textInput = document.getElementById('textInput');
            const textSubmitBtn = document.getElementById('textSubmitBtn');
            const textClearBtn = document.getElementById('textClearBtn');
            const statusContent = document.getElementById('statusContent');
            const historyContent = document.getElementById('historyContent');
            const currentTrack = document.getElementById('currentTrack');
            const trackTitle = document.getElementById('trackTitle');
            const audioPlayer = document.getElementById('audioPlayer');
            const volumeSlider = document.getElementById('volumeSlider');
            const visualizer = document.getElementById('visualizer');
            const usernameDisplay = document.getElementById('usernameDisplay');
            const logoutBtn = document.getElementById('logoutBtn');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const voiceOptions = document.querySelectorAll('.voice-option');
            
            // åº”ç”¨çŠ¶æ€
            let recognition;
            let isListening = false;
            let commandHistory = [];
            let currentGeneratedContent = null;
            
            // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
            function checkLoginStatus() {
                const userInfo = localStorage.getItem('radioAIUser');
                if (userInfo) {
                    const user = JSON.parse(userInfo);
                    usernameDisplay.textContent = user.isGuest ? 'è®¿å®¢æ¨¡å¼' : user.username;
                } else {
                    // å¦‚æœæ²¡æœ‰ç™»å½•ä¿¡æ¯ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢
                    window.location.href = 'login.html';
                }
            }
            
            // é€€å‡ºç™»å½•
            logoutBtn.addEventListener('click', function() {
                if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                    localStorage.removeItem('radioAIUser');
                    window.location.href = 'login.html';
                }
            });
            
            // åˆ›å»ºéŸ³é¢‘å¯è§†åŒ–æ•ˆæœ
            function createVisualizer() {
                visualizer.innerHTML = '';
                for (let i = 0; i < 30; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'visualizer-bar';
                    bar.style.left = `${i * 5.5}px`;
                    bar.style.animationDelay = `${i * 0.12}s`;
                    bar.style.height = `${Math.random() * 70 + 15}%`;
                    visualizer.appendChild(bar);
                }
            }
            
            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
            function updateStatus(message) {
                statusContent.innerHTML = `<span class="loading"></span> ${message}`;
                
                // æ·»åŠ åˆ°å†å²è®°å½•
                addToHistory(message);
            }
            
            // æ·»åŠ åˆ°å†å²è®°å½•
            function addToHistory(message) {
                commandHistory.unshift({
                    timestamp: new Date().toLocaleTimeString(),
                    message: message
                });
                
                // é™åˆ¶å†å²è®°å½•æ•°é‡
                if (commandHistory.length > 10) {
                    commandHistory = commandHistory.slice(0, 10);
                }
                
                // æ›´æ–°å†å²æ˜¾ç¤º
                historyContent.innerHTML = commandHistory.map(item => 
                    `<div><small>${item.timestamp}</small>: ${item.message}</div>`
                ).join('<br>');
            }
            
            // æ¸…ç©ºå†å²è®°å½•
            clearHistoryBtn.addEventListener('click', function() {
                commandHistory = [];
                historyContent.innerHTML = 'æš‚æ— å†å²è®°å½•';
                updateStatus('å†å²è®°å½•å·²æ¸…ç©º');
            });
            
            // AIè¯­éŸ³ç”Ÿæˆå†…å®¹
            async function generateAIContent(query) {
                updateStatus(`æ­£åœ¨åˆ†ææ‚¨çš„éœ€æ±‚: "${query}"`);
                
                try {
                    // ä½¿ç”¨AIè¯­éŸ³ç”Ÿæˆå™¨å¤„ç†ç”¨æˆ·è¯·æ±‚
                    const result = await aiVoiceGen.processUserRequest(query);
                    currentGeneratedContent = result;
                    
                    // æ›´æ–°çŠ¶æ€
                    updateStatus(`å·²ä¸ºæ‚¨ç”Ÿæˆå†…å®¹: "${result.generatedContent.substring(0, 50)}..."`);
                    
                    // æ’­æ”¾ç”Ÿæˆçš„è¯­éŸ³å†…å®¹
                    await playGeneratedContent(result.generatedContent);
                    
                } catch (error) {
                    console.error('AIè¯­éŸ³ç”Ÿæˆå¤±è´¥:', error);
                    updateStatus(`ç”Ÿæˆå†…å®¹æ—¶å‡ºé”™: ${error.message}`);
                }
            }
            
            // æ’­æ”¾ç”Ÿæˆçš„å†…å®¹
            async function playGeneratedContent(content) {
                trackTitle.textContent = 'AIç”Ÿæˆå†…å®¹';
                currentTrack.style.display = 'block';
                
                try {
                    // ç”ŸæˆAIè¯­éŸ³å†…å®¹
                    const speechResult = await aiVoiceGen.generateSpeech(content);
                    
                    // åˆ›å»ºå¯è§†åŒ–æ•ˆæœ
                    createVisualizer();
                    
                    // è®¾ç½®éŸ³é¢‘æºä½†ä¸è‡ªåŠ¨æ’­æ”¾ï¼ˆéµå®ˆæµè§ˆå™¨è‡ªåŠ¨æ’­æ”¾ç­–ç•¥ï¼‰
                    audioPlayer.src = speechResult.audioUrl;
                    audioPlayer.volume = volumeSlider.value;
                    
                    // æ›´æ–°çŠ¶æ€
                    updateStatus(`AIå†…å®¹å·²ç”Ÿæˆï¼Œç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æ’­æ”¾: "${content.substring(0, 30)}..."`);
                    
                    // ä¸è‡ªåŠ¨æ’­æ”¾ï¼Œè€Œæ˜¯ç­‰å¾…ç”¨æˆ·äº¤äº’
                    // æ˜¾ç¤ºæç¤ºè®©ç”¨æˆ·çŸ¥é“éœ€è¦ç‚¹å‡»æ’­æ”¾æŒ‰é’®
                    setTimeout(() => {
                        updateStatus(`æç¤º: è¯·åœ¨ä¸‹æ–¹ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æ’­æ”¾AIç”Ÿæˆçš„å†…å®¹`);
                    }, 1000);
                } catch (error) {
                    console.error('æ’­æ”¾ç”Ÿæˆå†…å®¹æ—¶å‡ºé”™:', error);
                    updateStatus(`æ’­æ”¾å†…å®¹æ—¶å‡ºé”™: ${error.message}`);
                }
            }
            
            // åœæ­¢æ’­æ”¾
            function stopAudio() {
                audioPlayer.pause();
                currentTrack.style.display = 'none';
            }
            
            // å¤„ç†è¯­éŸ³å‘½ä»¤
            async function processVoiceCommand(command) {
                updateStatus(`è¯†åˆ«åˆ°æŒ‡ä»¤: "${command}"`);
                
                // ç”ŸæˆAIå†…å®¹
                await generateAIContent(command);
            }
            
            // æ–‡å­—è¾“å…¥å¤„ç†
            async function processTextInput(text) {
                if (text.trim() === '') {
                    updateStatus('è¯·è¾“å…¥æ‚¨çš„éœ€æ±‚');
                    return;
                }
                
                await processVoiceCommand(text);
            }
            
            // å¿«æ·å‘½ä»¤å¤„ç†
            window.quickCommand = async function(command) {
                await processVoiceCommand(command);
            };
            
            // åˆå§‹åŒ–è¯­éŸ³è¯†åˆ«
            function initSpeechRecognition() {
                if ('webkitSpeechRecognition' in window) {
                    recognition = new webkitSpeechRecognition();
                } else if ('SpeechRecognition' in window) {
                    recognition = new SpeechRecognition();
                } else {
                    updateStatus('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ç°ä»£æµè§ˆå™¨');
                    return false;
                }
                
                recognition.continuous = true;
                recognition.interimResults = true;
                recognition.lang = 'zh-CN';
                
                recognition.onresult = function(event) {
                    let finalTranscript = '';
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        if (event.results[i].isFinal) {
                            finalTranscript += transcript;
                        }
                    }
                    
                    if (finalTranscript) {
                        processVoiceCommand(finalTranscript);
                    }
                };
                
                recognition.onerror = function(event) {
                    updateStatus('è¯­éŸ³è¯†åˆ«å‡ºé”™: ' + event.error);
                    isListening = false;
                    listenBtn.disabled = false;
                    stopBtn.disabled = true;
                };
                
                recognition.onend = function() {
                    if (isListening) {
                        // è‡ªåŠ¨é‡å¯è¯†åˆ«ï¼Œä¿æŒç›‘å¬çŠ¶æ€
                        try {
                            recognition.start();
                        } catch(e) {
                            console.log('Recognition already started');
                        }
                    } else {
                        // å¦‚æœæ‰‹åŠ¨åœæ­¢ï¼Œåˆ™æ›´æ–°UI
                        listenBtn.disabled = false;
                        stopBtn.disabled = true;
                    }
                };
                
                return true;
            }
            
            // å¼€å§‹ç›‘å¬æŒ‰é’®äº‹ä»¶
            listenBtn.addEventListener('click', function() {
                if (!initSpeechRecognition()) {
                    return;
                }
                
                try {
                    recognition.start();
                    isListening = true;
                    updateStatus('æ­£åœ¨è†å¬æ‚¨çš„æŒ‡ä»¤... è¯·è¯´è¯');
                    listenBtn.disabled = true;
                    stopBtn.disabled = false;
                } catch(e) {
                    updateStatus('æ— æ³•å¯åŠ¨è¯­éŸ³è¯†åˆ«: ' + e.message);
                }
            });
            
            // åœæ­¢ç›‘å¬æŒ‰é’®äº‹ä»¶
            stopBtn.addEventListener('click', function() {
                if (recognition) {
                    recognition.stop();
                    isListening = false;
                    updateStatus('å·²åœæ­¢è†å¬');
                    listenBtn.disabled = false;
                    stopBtn.disabled = true;
                }
            });
            
            // æ–‡å­—è¾“å…¥æäº¤äº‹ä»¶
            textSubmitBtn.addEventListener('click', async function() {
                const text = textInput.value.trim();
                if (text) {
                    await processTextInput(text);
                }
            });
            
            // æ–‡å­—è¾“å…¥åŒºåŸŸå›è½¦äº‹ä»¶
            textInput.addEventListener('keypress', async function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    await processTextInput(textInput.value.trim());
                }
            });
            
            // æ¸…ç©ºæ–‡å­—è¾“å…¥æ¡†
            textClearBtn.addEventListener('click', function() {
                textInput.value = '';
                textInput.focus();
            });
            
            // éŸ³é‡æ»‘å—å˜åŒ–äº‹ä»¶
            volumeSlider.addEventListener('input', function() {
                audioPlayer.volume = this.value;
                updateStatus(`éŸ³é‡å·²è°ƒæ•´è‡³ ${(this.value * 100).toFixed(0)}%`);
            });
            
            // ç›‘å¬éŸ³é¢‘æ’­æ”¾äº‹ä»¶
            audioPlayer.addEventListener('play', function() {
                updateStatus(`æ­£åœ¨æ’­æ”¾AIç”Ÿæˆå†…å®¹...`);
            });
            
            // ç›‘å¬éŸ³é¢‘æš‚åœäº‹ä»¶
            audioPlayer.addEventListener('pause', function() {
                updateStatus(`æ’­æ”¾å·²æš‚åœ`);
            });
            
            // ç›‘å¬éŸ³é¢‘ç»“æŸäº‹ä»¶
            audioPlayer.addEventListener('ended', function() {
                updateStatus(`æ’­æ”¾å·²å®Œæˆ`);
            });
            
            // åˆå§‹åŒ–è¯­éŸ³é€‰é¡¹
            function initVoiceSelection() {
                // ä¸ºæ¯ä¸ªè¯­éŸ³é€‰é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
                voiceOptions.forEach(option => {
                    option.addEventListener('click', function() {
                        // ç§»é™¤å…¶ä»–é€‰é¡¹çš„é€‰ä¸­çŠ¶æ€
                        voiceOptions.forEach(opt => opt.classList.remove('selected'));
                        
                        // ä¸ºå½“å‰é€‰é¡¹æ·»åŠ é€‰ä¸­çŠ¶æ€
                        this.classList.add('selected');
                        
                        // è®¾ç½®é€‰ä¸­çš„è¯­éŸ³
                        const voiceId = this.getAttribute('data-voice');
                        aiVoiceGen.setVoice(voiceId);
                        
                        updateStatus(`å·²é€‰æ‹©è¯­éŸ³: ${this.textContent}`);
                    });
                });
                
                // é»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ªè¯­éŸ³
                if (voiceOptions.length > 0) {
                    voiceOptions[0].classList.add('selected');
                    aiVoiceGen.setVoice(voiceOptions[0].getAttribute('data-voice'));
                }
            }
            
            // åˆå§‹åŒ–æŒ‰é’®çŠ¶æ€
            stopBtn.disabled = true;
            
            // åˆ›å»ºåˆå§‹å¯è§†åŒ–æ•ˆæœ
            createVisualizer();
            
            // æ£€æŸ¥ç™»å½•çŠ¶æ€
            checkLoginStatus();
            
            // é¡µé¢åŠ è½½å®Œæˆæç¤º
            updateStatus('æ¬¢è¿æ¥åˆ°æ²»æ„ˆç³»AIè¯­éŸ³ç”µå°ï¼è®©æ¸©æš–çš„å£°éŸ³é™ªä¼´æ‚¨');
            
            // åˆå§‹åŒ–è¯­éŸ³é€‰æ‹©
            initVoiceSelection();
        });
    </script>
</body>
</html>